*TITLE 'FULLSPSS.SAS ';

/*********************************************************************/
/* FULLSPSS.SAS is used to generate SPSS datalist statements for     */
/* data sets regardless of type and is based on information gathered */     
/* from the XRAY dataset. This program is called from RUNXRAY.SAS    */
/* Created: 10/13/2006. By Marc Maynard                              */
/* Last modified: 1/13/2012. By Marc Maynard                        */
/*********************************************************************/
/*Set directory.*/
FILENAME SPSS "C:\Users\jr945\Desktop\colbin_convert_syntax\FULLSPSS.sps" lrecl=32767; 
OPTIONS NOCENTER NODATE NONUMBER;
DATA _NULL_;
 FILE SPSS PRINT NOTITLES PS=2000 LS=32767;
*put 'clear';
IDSTRING =symget('ARCHNO');
OPNAME =symget('OPNAME');
FDIR = symget('dir') ;
TYPE = symget('XRAYTYPE');
CARD = symget('CARD');
SET XRAYSET end=Lastobs;
 length tmpvar $10. delRecVars $32767. delConfVars $32767. delBpVars  $32767. varRecodes $32767. varRenames $32767. varAformats $10000. varFformats1 $10000. varFformats2 $10000;
 retain alphavar tmpvar delRecVars delConfVars delBpVars varRecodes varRenames varAformats varFformats1 varFformats2 ;
if card = 1 and column = 1 then do;
* header information;
PUT '*ROPER CENTER SPSS DATA DEFINITIONS. ';
PUT '*STUDY:         ' IDSTRING  '.';
dsfn=PATHNAME("DATAIN");
put '*Type of run:       ' TYPE '.';
PUT '*Generated:     ' "%sysfunc (today(), mmddyys10.)" '.'; 
PUT '*Operator:      ' OPNAME '.';
* file handle;
if (TYPE = "multasc" or TYPE = "oneasc") then 
       PUT 'file handle indata name=''''' +(-1) dsfn +(-1) ''' .';
if (TYPE = "multbin" or TYPE = "onebin") then 
       PUT 'file handle indata name=''''' +(-1) dsfn +(-1) ''' /mode=multipunch.';
* data definition statements;
PUT 'DATA LIST FILE = indata  records = ' CARD ' TABLE ';
end;
if column = 1 then do;
 PUT '  /' card;
end;

*handle column binary data set;
if (TYPE = "multbin" or TYPE = "onebin") then do;
  if (substr(puX,1,1) = 'R') or (substr(puY,1,1) = 'R') or
     (substr(puX,1,1) = '*') or (substr(puY,1,1) = '*')then alphaVar = 1 ;
  else alphaVar = 0;

  *multipunch column input statement;
  if multstat > 0 then do;
    if pu1 NE '' then do; PUT @2 'c'COLUMN +(-1) '_p1     '  column +(-1) ':4';   varFformats1 = trim(varFformats1) ||'    c'|| trim(left(COLUMN))||'_p1'||'0a'x  ; end;
    if pu2 NE '' then do; PUT @2 'c'COLUMN +(-1) '_p2     '  column +(-1) ':5' ;  varFformats1 = trim(varFformats1) ||'    c'|| trim(left(COLUMN))||'_p2'||'0a'x  ; end;
    if pu3 NE '' then do; PUT @2 'c'COLUMN +(-1) '_p3     '  column +(-1) ':6' ;  varFformats1 = trim(varFformats1) ||'    c'|| trim(left(COLUMN))||'_p3'||'0a'x  ; end;
    if pu4 NE '' then do; PUT @2 'c'COLUMN +(-1) '_p4     '  column +(-1) ':7' ;  varFformats1 = trim(varFformats1) ||'    c'|| trim(left(COLUMN))||'_p4'||'0a'x  ; end;
    if pu5 NE '' then do; PUT @2 'c'COLUMN +(-1) '_p5     '  column +(-1) ':8' ;  varFformats1 = trim(varFformats1) ||'    c'|| trim(left(COLUMN))||'_p5'||'0a'x  ; end;
    if pu6 NE '' then do; PUT @2 'c'COLUMN +(-1) '_p6     '  column +(-1) ':9' ;  varFformats1 = trim(varFformats1) ||'    c'|| trim(left(COLUMN))||'_p6'||'0a'x  ; end;
    if pu7 NE '' then do; PUT @2 'c'COLUMN +(-1) '_p7     '  column +(-1) ':10' ; varFformats1 = trim(varFformats1) ||'    c'|| trim(left(COLUMN))||'_p7'||'0a'x  ; end;
    if pu8 NE '' then do; PUT @2 'c'COLUMN +(-1) '_p8     '  column +(-1) ':11' ; varFformats1 = trim(varFformats1) ||'    c'|| trim(left(COLUMN))||'_p8'||'0a'x  ; end;
    if pu9 NE '' then do; PUT @2 'c'COLUMN +(-1) '_p9     '  column +(-1) ':12' ; varFformats1 = trim(varFformats1) ||'    c'|| trim(left(COLUMN))||'_p9'||'0a'x  ; end;
    if pu0 NE '' then do; PUT @2 'c'COLUMN +(-1) '_p0     '  column +(-1) ':3' ;  varFformats1 = trim(varFformats1) ||'    c'|| trim(left(COLUMN))||'_p0'||'0a'x  ; end;
    if puX NE '' then do; PUT @2 'c'COLUMN +(-1) '_pX     '  column +(-1) ':2' ;  varFformats1 = trim(varFformats1) ||'    c'|| trim(left(COLUMN))||'_pX'||'0a'x  ; end;
    if puY NE '' then do; PUT @2 'c'COLUMN +(-1) '_pY     '  column +(-1) ':1' ;  varFformats1 = trim(varFformats1) ||'    c'|| trim(left(COLUMN))||'_pY'||'0a'x  ; end;
    end;
  *single punch column input statement as character variable;
  else if multstat = 0 and alphaVar = 1 and (pu1 NE '' or pu2 NE '' or pu3 NE '' or pu4 NE '' or pu5 NE '' or pu6 NE '' or 
        pu7 NE '' or pu8 NE '' or pu9 NE '' or pu0 NE '' or puX NE '' or puY NE '') 
    then PUT @2 'c'COLUMN '     ' COLUMN ' (a) ' ;
  *single punch column input statement as numeric variable;
  else if multstat = 0 and alphaVar = 0 and (pu1 NE '' or pu2 NE '' or pu3 NE '' or pu4 NE '' or pu5 NE '' or pu6 NE '' or 
        pu7 NE '' or pu8 NE '' or pu9 NE '' or pu0 NE '' ) 
    then PUT @2 'c'COLUMN '     ' COLUMN '  ' ;

   
	if (multstat > 0 ) then do; 	/* multipunched variable  */
      if substr(pu1,1,1) = 'R' then do;
		 if alphaVar = 1 then do; 
		  if substr(pu1,2) NE tmpvar then do;
               recode = ' STRING ' || substr(pu1,2) || ' (a1).' || '0a'x  ;
               varRecodes = catt(varRecodes,recode);
		  end;
	      tmpvar = substr(pu1,2,6);
		  varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p1 (1=''1'') into '||tmpvar||'.'||'0a'x ;
		 end;
		 else if alphaVar = 0 then do;
		  if substr(pu1,2) NE tmpvar then do;
	       varFformats2= trim(varFformats2)||'    '|| trim(left(substr(pu1,2))) ||'0a'x  ;
		  end;
          tmpvar = substr(pu1,2,6);
          varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p1 (1=1) into '||tmpvar||'.'||'0a'x ;
         end;
         delRecVars = catt(delRecVars,' c',COLUMN,'_p1');
       end; 
	  else if substr(pu1,1,1) = 'B' then do;
		 delBpVars = catt(delBpVars,' c',COLUMN,'_p1'); 
	  end;
	  else if substr(pu1,1,1) = 'C' then do;
		 delConfVars = catt(delConfVars,' c',COLUMN,'_p1'); 
	  end;
      if substr(pu2,1,1) = 'R' then do;
		 if alphaVar = 1 then do; 
		  if substr(pu2,2) NE tmpvar then do;
               recode = ' STRING ' || substr(pu2,2) || ' (a1).' || '0a'x  ;
               varRecodes = catt(varRecodes,recode);
		  end;
	      tmpvar = substr(pu2,2,6);
		  varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p2 (1=''2'') into '||tmpvar||'.'||'0a'x ;
		 end;
		 else if alphaVar = 0 then do;
		  if substr(pu2,2) NE tmpvar then do;
	       varFformats2= trim(varFformats2)||'    '|| trim(left(substr(pu2,2))) ||'0a'x  ;
		  end;
          tmpvar = substr(pu2,2,6);
          varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p2 (1=2) into '||tmpvar||'.'||'0a'x ;
         end;
		 delRecVars = catt(delRecVars,' c',COLUMN,'_p2'); 
	  end;
	  else if substr(pu2,1,1) = 'B' then do;
		 delBpVars = catt(delBpVars,' c',COLUMN,'_p2'); 
	  end;
	  else if substr(pu2,1,1) = 'C' then do;
		 delConfVars = catt(delConfVars,' c',COLUMN,'_p2'); 
	  end;
      if substr(pu3,1,1) = 'R' then do;
		 if alphaVar = 1 then do; 
		  if substr(pu3,2) NE tmpvar then do;
               recode = ' STRING ' || substr(pu3,2) || ' (a1).' || '0a'x  ;
               varRecodes = catt(varRecodes,recode);
		  end;
	      tmpvar = substr(pu3,2,6);
		  varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p3 (1=''3'') into '||tmpvar||'.'||'0a'x ;
		 end;
		 else if alphaVar = 0 then do;
		  if substr(pu3,2) NE tmpvar then do;
	       varFformats2= trim(varFformats2)||'    '|| trim(left(substr(pu3,2))) ||'0a'x  ;
		  end;
          tmpvar = substr(pu3,2,6);
          varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p3 (1=3) into '||tmpvar||'.'||'0a'x ;
         end;
		 delRecVars = catt(delRecVars,' c',COLUMN,'_p3'); 
	  end;
	  else if substr(pu3,1,1) = 'B' then do;
		 delBpVars = catt(delBpVars,' c',COLUMN,'_p3'); 
	  end;
 	  else if substr(pu3,1,1) = 'C' then do;
		 delConfVars = catt(delConfVars,' c',COLUMN,'_p3'); 
	  end;
     if substr(pu4,1,1) = 'R' then do;
		 if alphaVar = 1 then do; 
		  if substr(pu4,2) NE tmpvar then do;
               recode = ' STRING ' || substr(pu4,2) || ' (a1).' || '0a'x  ;
               varRecodes = catt(varRecodes,recode);
		  end;
	      tmpvar = substr(pu4,2,6);
		  varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p4 (1=''4'') into '||tmpvar||'.'||'0a'x ;
		 end;
		 else if alphaVar = 0 then do;
		  if substr(pu4,2) NE tmpvar then do;
	       varFformats2= trim(varFformats2)||'    '|| trim(left(substr(pu4,2))) ||'0a'x  ;
		  end;
          tmpvar = substr(pu4,2,6);
          varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p4 (1=4) into '||tmpvar||'.'||'0a'x ;
         end;
		 delRecVars = catt(delRecVars,' c',COLUMN,'_p4'); 
	  end;
	  else if substr(pu4,1,1) = 'B' then do;
		 delBpVars = catt(delBpVars,' c',COLUMN,'_p4'); 
	  end;
 	  else if substr(pu4,1,1) = 'C' then do;
		 delConfVars = catt(delConfVars,' c',COLUMN,'_p4'); 
	  end;
      if substr(pu5,1,1) = 'R' then do;
		 if alphaVar = 1 then do; 
		  if substr(pu5,2) NE tmpvar then do;
               recode = ' STRING ' || substr(pu5,2) || ' (a1).' || '0a'x  ;
               varRecodes = catt(varRecodes,recode);
		  end;
	      tmpvar = substr(pu5,2,6);
		  varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p5 (1=''5'') into '||tmpvar||'.'||'0a'x ;
		 end;
		 else if alphaVar = 0 then do;
          tmpvar = substr(pu5,2,6);
		  if substr(pu5,2) NE tmpvar then do;
	       varFformats2= trim(varFformats2)||'    '|| trim(left(substr(pu5,2))) ||'0a'x  ;
		  end;
          varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p5 (1=5) into '||tmpvar||'.'||'0a'x ;
         end;
		 delRecVars = catt(delRecVars,' c',COLUMN,'_p5'); 
	  end;
	  else if substr(pu5,1,1) = 'B' then do;
		 delBpVars = catt(delBpVars,' c',COLUMN,'_p5'); 
	  end;
 	  else if substr(pu5,1,1) = 'C' then do;
		 delConfVars = catt(delConfVars,' c',COLUMN,'_p5'); 
	  end;
      if substr(pu6,1,1) = 'R' then do;
		 if alphaVar = 1 then do; 
		  if substr(pu6,2) NE tmpvar then do;
               recode = ' STRING ' || substr(pu6,2) || ' (a1).' || '0a'x  ;
               varRecodes = catt(varRecodes,recode);
		  end;
	      tmpvar = substr(pu6,2,6);
		  varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p6 (1=''6'') into '||tmpvar||'.'||'0a'x ;
		 end;
		 else if alphaVar = 0 then do;
		  if substr(pu6,2) NE tmpvar then do;
	       varFformats2= trim(varFformats2)||'    '|| trim(left(substr(pu6,2))) ||'0a'x  ;
		  end;
          tmpvar = substr(pu6,2,6);
          varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p6 (1=6) into '||tmpvar||'.'||'0a'x ;
         end;
		 delRecVars = catt(delRecVars,' c',COLUMN,'_p6','0a'x); 
	  end;
	  else if substr(pu6,1,1) = 'B' then do;
		 delBpVars = catt(delBpVars,' c',COLUMN,'_p6','0a'x ); 
	  end;
 	  else if substr(pu6,1,1) = 'C' then do;
		 delConfVars = catt(delConfVars,' c',COLUMN,'_p6'); 
	  end;
      if substr(pu7,1,1) = 'R' then do;
		 if alphaVar = 1 then do; 
		  if substr(pu7,2) NE tmpvar then do;
               recode = ' STRING ' || substr(pu7,2) || ' (a1).' || '0a'x  ;
               varRecodes = catt(varRecodes,recode);
		  end;
	      tmpvar = substr(pu7,2,6);
		  varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p7 (1=''7'') into '||tmpvar||'.'||'0a'x ;
		 end;
		 else if alphaVar = 0 then do;
		  if substr(pu7,2) NE tmpvar then do;
	       varFformats2= trim(varFformats2)||'    '|| trim(left(substr(pu7,2))) ||'0a'x  ;
		  end;
          tmpvar = substr(pu7,2,6);
          varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p7 (1=7) into '||tmpvar||'.'||'0a'x ;
         end;
		 delRecVars = catt(delRecVars,' c',COLUMN,'_p7'); 
	  end;
	  else if substr(pu7,1,1) = 'B' then do;
		 delBpVars = catt(delBpVars,' c',COLUMN,'_p7'); 
	  end;
 	  else if substr(pu7,1,1) = 'C' then do;
		 delConfVars = catt(delConfVars,' c',COLUMN,'_p7'); 
	  end;
      if substr(pu8,1,1) = 'R' then do;
		 if alphaVar = 1 then do; 
		  if substr(pu8,2) NE tmpvar then do;
               recode = ' STRING ' || substr(pu8,2) || ' (a1).' || '0a'x  ;
               varRecodes = catt(varRecodes,recode);
		  end;
	      tmpvar = substr(pu8,2,6);
		  varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p8 (1=''8'') into '||tmpvar||'.'||'0a'x ;
		 end;
		 else if alphaVar = 0 then do;
		  if substr(pu8,2) NE tmpvar then do;
	       varFformats2= trim(varFformats2)||'    '|| trim(left(substr(pu8,2))) ||'0a'x  ;
		  end;
          tmpvar = substr(pu8,2,6);
          varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p8 (1=8) into '||tmpvar||'.'||'0a'x ;
         end;
		 delRecVars = catt(delRecVars,' c',COLUMN,'_p8'); 
	  end;
	  else if substr(pu8,1,1) = 'B' then do;
		 delBpVars = catt(delBpVars,' c',COLUMN,'_p8'); 
	  end;
 	  else if substr(pu8,1,1) = 'C' then do;
		 delConfVars = catt(delConfVars,' c',COLUMN,'_p8'); 
	  end;
      if substr(pu9,1,1) = 'R' then do;
		 if alphaVar = 1 then do; 
		  if substr(pu9,2) NE tmpvar then do;
               recode = ' STRING ' || substr(pu9,2) || ' (a1).' || '0a'x  ;
               varRecodes = catt(varRecodes,recode);
		  end;
	      tmpvar = substr(pu9,2,6);
		  varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p9 (1=''9'') into '||tmpvar||'.'||'0a'x ;
		 end;
		 else if alphaVar = 0 then do;
		  if substr(pu9,2) NE tmpvar then do;
	       varFformats2= trim(varFformats2)||'    '|| trim(left(substr(pu9,2))) ||'0a'x  ;
		  end;
          tmpvar = substr(pu9,2,6);
          varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p9 (1=9) into '||tmpvar||'.'||'0a'x ;
         end;
		 delRecVars = catt(delRecVars,' c',COLUMN,'_p9'); 
	  end;
	  else if substr(pu9,1,1) = 'B' then do;
		 delBpVars = catt(delBpVars,' c',COLUMN,'_p9'); 
	  end;
  	  else if substr(pu9,1,1) = 'C' then do;
		 delConfVars = catt(delConfVars,' c',COLUMN,'_p9'); 
	  end;
     if substr(pu0,1,1) = 'R' then do;
		 if alphaVar = 1 then do; 
		  if substr(pu0,2) NE tmpvar then do;
               recode = ' STRING ' || substr(pu0,2) || ' (a1).' || '0a'x  ;
               varRecodes = catt(varRecodes,recode);
		  end;
	      tmpvar = substr(pu0,2,6);
		  varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p0 (1=''0'') into '||tmpvar||'.'||'0a'x ;
		 end;
		 else if alphaVar = 0 then do;
		  if substr(pu0,2) NE tmpvar then do;
	       varFformats2= trim(varFformats2)||'    '|| trim(left(substr(pu0,2))) ||'0a'x  ;
		  end;
          tmpvar = substr(pu0,2,6);
          varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_p0 (1=0) into '||tmpvar||'.'||'0a'x ;
         end;
		 delRecVars = trim(delRecVars) ||' c'||trim(left(COLUMN))||'_p0'||'0a'x ; 
	  end;
	  else if substr(pu0,1,1) = 'B' then do;
		 delBpVars = trim(delBpVars)||' c'||trim(left(COLUMN))||'_p0'||'0a'x ; 
	  end;
  	  else if substr(pu0,1,1) = 'C' then do;
		 delConfVars = catt(delConfVars,' c',COLUMN,'_p0'); 
	  end;
     if substr(puX,1,1) = 'R' then do;
		 if substr(puX,2) NE tmpvar then do;
               recode = ' STRING ' || substr(puX,2) || ' (a1).' || '0a'x  ;
               varRecodes = catt(varRecodes,recode);
		 end;
	     if substr(puX,2) NE tmpvar then do;
	      varFformats2= trim(varFformats2)||'    '|| trim(left(substr(puX,2))) ||'0a'x  ;
		 end;
	     tmpvar = substr(puX,2,6);
         varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_pX (1=''X'') into '||tmpvar||'.'||'0a'x ;
		 delRecVars = catt(delRecVars,' c',COLUMN,'_pX'); 
	  end;
	  else if substr(puX,1,1) = 'B' then do;
		 delBpVars = catt(delBpVars,' c',COLUMN,'_pX'); 
	  end;
 	  else if substr(puX,1,1) = 'C' then do;
		 delConfVars = catt(delConfVars,' c',COLUMN,'_pX'); 
	  end;
      if substr(puY,1,1) = 'R' then do;
		 if substr(puY,2) NE tmpvar then do;
               recode = ' STRING ' || substr(puY,2) || ' (a1).' || '0a'x  ;
               varRecodes = catt(varRecodes,recode);
		 end;
		  if substr(puY,2) NE tmpvar then do;
	       varFformats2= trim(varFformats2)||'    '|| trim(left(substr(puY,2))) ||'0a'x  ;
		  end;
	     tmpvar = substr(puY,2,6);
         varRecodes = trim(varRecodes) ||' RECODE c' || trim(left(COLUMN)) || '_pY (1=''Y'') into '||tmpvar||'.'||'0a'x ;
		 delRecVars = catt(delRecVars,' c',COLUMN,'_pY'); 
	  end;
	  else if substr(puY,1,1) = 'B' then do;
		 delBpVars = catt(delBpVars,' c',COLUMN,'_pY'); 
	  end;
 	  else if substr(puY,1,1) = 'C' then do;
		 delConfVars = catt(delConfVars,' c',COLUMN,'_pY'); 
	  end;
   end;

   if (multstat > 0 and VARNAME NE '') then do;	/* multipunched variable to be renamed  */
      if substr(pu1,1,1) = '*' then do;
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '_p1 = ' || trim(left(VARNAME)) || '_p1 ).' ||'0a'x ;
	     varFformats2= trim(varFformats2)||'    '|| trim(left(VARNAME)) || '_p1' ||'0a'x  ;
      end; 
      if substr(pu2,1,1) = '*' then do;
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '_p2 = ' || trim(left(VARNAME)) || '_p2 ).' ||'0a'x ;
	     varFformats2= trim(varFformats2)||'    '|| trim(left(VARNAME)) || '_p2' ||'0a'x  ;
	  end;
      if substr(pu3,1,1) = '*' then do;
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '_p3 = ' || trim(left(VARNAME)) || '_p3 ).' ||'0a'x ;
	     varFformats2= trim(varFformats2)||'    '|| trim(left(VARNAME)) || '_p3' ||'0a'x  ;
	  end;
      if substr(pu4,1,1) = '*' then do;
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '_p4 = ' || trim(left(VARNAME)) || '_p4 ).' ||'0a'x ;
	     varFformats2= trim(varFformats2)||'    '|| trim(left(VARNAME)) || '_p4' ||'0a'x  ;
	  end;
      if substr(pu5,1,1) = '*' then do;
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '_p5 = ' || trim(left(VARNAME)) || '_p5 ).' ||'0a'x ;
	     varFformats2= trim(varFformats2)||'    '|| trim(left(VARNAME)) || '_p5' ||'0a'x  ;
	  end;
      if substr(pu6,1,1) = '*' then do;
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '_p6 = ' || trim(left(VARNAME)) || '_p6 ).' ||'0a'x ;
	     varFformats2= trim(varFformats2)||'    '|| trim(left(VARNAME)) || '_p6' ||'0a'x  ;
	  end;
      if substr(pu7,1,1) = '*' then do;
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '_p7 = ' || trim(left(VARNAME)) || '_p7 ).' ||'0a'x ;
	     varFformats2= trim(varFformats2)||'    '|| trim(left(VARNAME)) || '_p7' ||'0a'x  ;
	  end;
      if substr(pu8,1,1) = '*' then do;
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '_p8 = ' || trim(left(VARNAME)) || '_p8 ).' ||'0a'x ;
	     varFformats2= trim(varFformats2)||'    '|| trim(left(VARNAME)) || '_p8' ||'0a'x  ;
	  end;
      if substr(pu9,1,1) = '*' then do;
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '_p9 = ' || trim(left(VARNAME)) || '_p9 ).' ||'0a'x ;
	     varFformats2= trim(varFformats2)||'    '|| trim(left(VARNAME)) || '_p9' ||'0a'x  ;
	  end;
      if substr(pu0,1,1) = '*' then do;
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '_p0 = ' || trim(left(VARNAME)) || '_p0 ).' ||'0a'x ;
	     varFformats2= trim(varFformats2)||'    '|| trim(left(VARNAME)) || '_p0' ||'0a'x  ;
	  end;
      if substr(puX,1,1) = '*' then do;
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '_pX = ' || trim(left(VARNAME)) || '_pX ).' ||'0a'x ;
	     varFformats2= trim(varFformats2)||'    '|| trim(left(VARNAME)) || '_pX' ||'0a'x  ;
	  end;
      if substr(puY,1,1) = '*' then do;
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '_pY = ' || trim(left(VARNAME)) || '_pY ).' ||'0a'x ;
	     varFformats2= trim(varFformats2)||'    '|| trim(left(VARNAME)) || '_pY' ||'0a'x  ;
	  end;
	end;


	if (multstat = 0 and alphaVar = 1 and varname NE '' ) then do;	/* rename single-punched character variable  */
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '=' || trim(left(VARNAME)) || ').'||'0a'x ;
		 varRecodes = trim(varRecodes) ||' RECODE ' || trim(left(VARNAME)) || '(''-''=''X'') (''&''=''Y'').'||'0a'x ;
	end;

	if (multstat = 0 and alphaVar NE 1 and varname NE '' ) then do; 	/* rename single-punched numeric variable  */
         varRenames = trim(varRenames) ||' RENAME VARIABLE (c' || trim(left(COLUMN)) || '=' || trim(left(VARNAME)) || ').'||'0a'x ;
    end;


end; 


if (TYPE = "multasc" or TYPE = "oneasc") then do;
  if nonblnk > 0 then do;
    if colothr = 0 then put @2 'c'card +(-1) 'q'column '       '  column  ;
    if colothr > 0 then put @2 'c'card +(-1) 'q'column '       '  column '(a)';
    end;
end;

if Lastobs then do;
put @2 ' ';
PUT '.';
PUT 'execute.';
put @2 ' ';
put @2 ' ';
put @2 '** Modify formats of original variables **.';
put @2 'ALTER TYPE ';
put @4 varFformats1'   (f=f1) .';
PUT 'execute.';
put @2 ' ';
put @2 ' ';
put @2 '** Rename selected variables **.';
put @2 '** Example: **.';
put @2 '** RENAME VARIABLES (c3=Q3). **.';
put @2 varRenames;
PUT '.';
PUT 'execute.';
put @2 ' ';
put @2 ' ';
put @2 '** Generate Recodes & Consolidate Multipunches if Applicable**.';
put @2 '** Examples: **.';
put @2 '** ';
put @2 '** Example 1:';
put @2 '** *Q01';
put @2 '** COMPUTE count= sum(c1_pY TO c1_pX).';
put @2 '** FREQUENCIES count.';
put @2 '** CROSSTABS count BY c1_pY TO c1_pX.';
put @2 '**  ';
put @2 '** STRING Q01    (a3).';
put @2 '**  RECODE c1_pY (1="12") into Q01      .';
put @2 '**  RECODE c1_pX (1="11") into Q01      .';
put @2 '**  RECODE count (2 thru highest="777") into Q01        .';
put @2 '** EXECUTE.';
put @2 '** Fre Q01.';
put @2 '** DELETE VARIABLES count.';
put @2 '**  ';
put @2 '** Example 2:';
put @2 '** *Recode - (X) and & (Y) values into string numbers (11 and 12 respectively).';
put @2 '** RECODE c1 ("-"="11") ("&"="12").';
put @2 '** RECODE c3 ("-"="11") ("&"="12").';
put @2 '** RECODE c4 ("-"="11") ("&"="12").';
put @2 '** RECODE c66 ("-"="11") ("&"="12").';
put @2 '** RECODE c69 ("-"="11") ("&"="12").**';
put @2 varRecodes;
PUT '.';
PUT 'execute.';
put @2 ' ';
put @2 ' ';
put @2 '** Modify formats of new variables **.';
put @2 '** Example: **.';
put @2 '** ALTER TYPE c1 (f=f2).';
PUT @2 'ALTER TYPE ';
put @4 varFformats2'   (f=f2) .';
PUT 'execute.';
put @2 ' ';
put @2 ' ';



put @2 '** Recoded Variables to delete **.';
put @2 '** Examples: **.';
put @2 '** DELETE VARIABLES c78 c79 c80_pX c80_p8.';
put @2 '** DELETE VARIABLES c21_pY TO c23_p9.';
put @2 'DELETE VARIABLES ' delRecVars '.';
put @2 ' ';
PUT '.';
PUT 'execute.';
put @2 '** Confidentiality Check Variables to delete **.';
put @2 '** Example: **.';
put @2 '** DELETE VARIABLES county zip fips phone bday name. **.';
put @2 'DELETE VARIABLES ' delConfVars '.';
PUT '.';
PUT 'execute.';
put @2 ' ';
put @2 '** Bad punched Variables to delete **.';
put @2 'DELETE VARIABLES ' delBpVars '.';
PUT '.';
PUT 'execute.';
put @2 ' ';
put @2 '** Supplementary Recodes **.';
put @2 ' ';
put @2 '** place any additional recodes here **.';
put @2 ' ';
PUT '.';
PUT 'execute.';


put @2 ' ';

 PUT '.';
 PUT 'execute.';
end; 
RUN;


